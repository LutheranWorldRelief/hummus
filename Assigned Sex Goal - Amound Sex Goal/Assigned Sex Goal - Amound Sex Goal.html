<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,100,300,700' rel='stylesheet' type='text/css'>
    <title>Document</title>
</head>
<body>
<style type="text/css">
    body, html {
        background: #181E24;
        padding-top: 10px;
    }

    .wrapper {
        width: 60%;
        display: block;
        overflow: hidden;
        margin: 0 auto;
        padding: 60px 50px;
        background: #fff;
        border-radius: 4px;
    }

    canvas {
        background: #fff;
        height: 400px;
    }

    h1 {
        font-family: Roboto;
        color: #fff;
        margin-top: 50px;
        font-weight: 200;
        text-align: center;
        display: block;
        text-decoration: none;
    }
</style>
<h1>Assigned Sex Goal - Amound Sex Goal</h1>
<div class="wrapper">
    <div id="main" style="height:400px;"></div>
</div>
<script src="https://cdn.jsdelivr.net/npm/echarts@4.5.0/dist/echarts.min.js"></script>
_
<script type='text/javascript'>

    fetch('./api-participants.json', {mode: 'no-cors'}).then((response) => {
        response.json().then((data) => {

            let anios = [];
            let totalHombres = [];
            let totalMujeres = [];
            let mujeres = [];
            let hombres = [];


            setZeroIsUndefined = (data) => {
                return data === undefined ? 0 : data
            };

            for (const participants in data['year']) {
                anios.push(participants);
                mujeres.push(setZeroIsUndefined(data['year'][participants].F));
                hombres.push(setZeroIsUndefined(data['year'][participants].M));
            }


            let myChart = echarts.init(document.getElementById('main'));

            // Random Asignar met
            mujeres.forEach(function (numero, index) {
                if (Math.floor(Math.random() * 10) % 2 === 0)
                    totalMujeres.push(numero + (index * 100));
                else if (numero < 200)
                    totalMujeres.push(numero + (300));
                else
                    totalMujeres.push(numero - (300));
            });

            hombres.forEach(function (numero, index) {
                if (Math.floor(Math.random() * 10) % 2 === 0)
                    totalHombres.push(numero + (index * 100));
                else if (numero < 200)
                    totalHombres.push(numero + (300));
                else
                    totalHombres.push(numero - (300));
            });

            let color = {
                mt: "rgba(42,123,153,.9)",// MT
                ft: "rgba(68,87,113,1)",// FT
                m: "rgba(255,205,85,.8)", //M
                f: "rgba(252,110,81,.8)",//F

            };

            let label = {
                normal: {
                    show: true,
                    position: 'top',
                    distance: 15,
                    verticalAlign: 'middle',
                    formatter: function (param) {
                        return param.value;
                    },
                    textStyle: {
                        color: 'black',
                        fontSize: '11',

                    },
                    rotate: 90
                }
            };


            let option = {
                tooltip: {
                    show: "true",
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow',// 'line' | 'shadow'
                        shadowStyle: {
                            color: 'rgba(112,112,112,0)',
                        },
                    },
                    formatter: function (params) {
                        let axisValue = `<p>${params[0].axisValue}</p>`;
                        params.forEach(item => {
                            axisValue += `<p>${item.marker} ${item.seriesName}: ${item.data}</p>`;
                        });
                        return axisValue;
                    },
                    backgroundColor: 'rgba(0,0,0,0.7)',
                    padding: [6, 6],
                    extraCssText: 'box-shadow: 0 0 3px rgba(255, 255, 255, 0.4);',
                },
                legend: {
                    data: ['Mujeres', 'Mujeres total', 'Hombres', 'Hombres total'],
                    textStyle: {
                        color: '#4f5f6f',
                    },
                    bottom: 'bottom',
                },
                xAxis: {
                    boundaryGap: true,
                    axisLine: {
                        show: false
                    },
                    data: anios
                },
                yAxis: {
                    type: 'value',
                    axisLine: {
                        show: true,
                    }
                },
                series: [
                    {
                        name: 'Mujeres',
                        type: 'bar',
                        label: label,
                        barWidth: 8,
                        z: 10,
                        itemStyle: {
                            normal: {
                                color: color.f
                            }
                        },
                        data: mujeres
                    }, {
                        name: 'Mujeres total',
                        type: 'bar',
                        barWidth: 20,
                        itemStyle: {
                            normal: {
                                color: color.ft
                            }
                        },
                        data: totalMujeres
                    },
                    {
                        name: 'Hombres',
                        type: 'bar',
                        barGap: '-175%',
                        label: label,
                        barWidth: 8,
                        z: 10,
                        itemStyle: {
                            normal: {
                                color: color.m
                            }
                        },
                        data: hombres
                    },
                    {
                        name: 'Hombres total',
                        type: 'bar',
                        barWidth: 20,
                        itemStyle: {
                            normal: {
                                color: color.mt
                            }
                        },

                        data: totalHombres
                    },
                ]
            };

            myChart.setOption(option);

            window.onresize = function () {
                myChart.resize();
            };
        });
    });

</script>
</body>
</html>
